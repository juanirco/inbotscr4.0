import{Animations}from"../components/animations.js";import{Interactions}from"../components/interactions.js";export class SmartbotsPage{constructor(){this.animations=new Animations,this.interactions=new Interactions,this.messageIndex=0,this.isTyping=!1,this.init()}init(){this.setupChatSimulation(),this.setupROICalculator(),this.setupInteractiveElements(),this.animations.initializeAll()}setupChatSimulation(){const e=[{type:"user",text:"Hola, ¿tienen servicio de delivery?",delay:500},{type:"bot",text:"¡Hola! Sí, tenemos delivery en toda la ciudad 😊 ¿En qué zona te encuentras?",delay:2e3},{type:"user",text:"Estoy en el centro, ¿cuánto tardan?",delay:3e3},{type:"bot",text:"Perfecto, al centro llegamos en 25-30 minutos. ¿Te gustaría ver nuestro menú especial de hoy? Tenemos 20% de descuento 🎉",delay:2500},{type:"user",text:"¡Sí! ¿Qué recomiendan?",delay:3500},{type:"bot",text:"Te recomiendo nuestro combo premium: incluye plato principal, bebida y postre por $25. ¿Te parece bien? Puedo tomar tu pedido ahora mismo 🍽️",delay:3e3},{type:"user",text:"Perfecto, quiero ese combo",delay:4e3},{type:"bot",text:"¡Excelente elección! 🎯 VENTA CERRADA: $25 en menos de 2 minutos. ¿Necesitas algo más?",delay:4e3}],t=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&0===this.messageIndex&&setTimeout(()=>{this.showChatMessage(e,0)},1e3)})}),o=document.querySelector(".chat-simulation");o&&t.observe(o)}showChatMessage(e,t){if(t>=e.length)return void setTimeout(()=>{const t=document.getElementById("chatMessages");t&&(t.innerHTML="",this.messageIndex=0,this.showChatMessage(e,0))},3e3);const o=e[t];setTimeout(()=>{"bot"!==o.type||this.isTyping?(this.addChatMessage(o),this.messageIndex++,this.showChatMessage(e,t+1)):(this.showTyping(),setTimeout(()=>{this.hideTyping(),this.addChatMessage(o),this.messageIndex++,this.showChatMessage(e,t+1)},1500))},o.delay)}addChatMessage(e){const t=document.getElementById("chatMessages");if(!t)return;const o=document.createElement("div");o.className="message "+e.type;const n=document.createElement("div");n.className="message-bubble",n.textContent=e.text,e.text.includes("VENTA CERRADA")&&(n.style.background="var(--gradient-success)",n.style.fontWeight="600",n.style.boxShadow="0 0 20px rgba(0, 255, 136, 0.4)"),o.appendChild(n),t.appendChild(o),t.scrollTop=t.scrollHeight}showTyping(){const e=document.getElementById("typingIndicator");e&&(e.style.opacity="1",this.isTyping=!0)}hideTyping(){const e=document.getElementById("typingIndicator");e&&(e.style.opacity="0",this.isTyping=!1)}setupROICalculator(){document.getElementById("roiModal")||this.createROIModal(),window.showROICalculator=()=>{document.getElementById("roiModal").style.display="flex"},window.closeModal=()=>{document.getElementById("roiModal").style.display="none"},window.calculateROI=()=>{const e=parseInt(document.getElementById("dailyQueries").value)||0,t=parseInt(document.getElementById("avgTicket").value)||0;if(e<=0||t<=0)return void alert("Por favor, completa todos los campos con valores válidos.");const o=30*e,n=.2*o*t-.05*o*t-1600,s=12*n;document.getElementById("roiResult").innerHTML=`\n                <div style="background: var(--gradient-success); padding: 1.5rem; border-radius: 15px; margin-top: 1rem;">\n                    <div style="font-size: 1.5rem; margin-bottom: 1rem;">🎯 Tu ROI Proyectado:</div>\n                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">+${n.toFixed(0)} USD/mes</div>\n                    <div style="font-size: 1.8rem; margin-bottom: 1rem;">+${s.toFixed(0)} USD/año</div>\n                    <div style="font-size: 1rem; opacity: 0.9;">ROI: ${(n/1600*100).toFixed(0)}% mensual</div>\n                </div>\n                <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-secondary);">\n                    *Cálculo basado en mejora conservadora del 15% en conversiones\n                </div>\n            `},window.startDemo=()=>{window.open("https://wa.me/50686324262?text=Hola! Quiero conocer más sobre los smartbots y ver una demo personalizada","_blank")}}createROIModal(){const e=document.createElement("div");e.id="roiModal",e.style.cssText="\n            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; \n            background: rgba(0,0,0,0.9); z-index: 10000; align-items: center; justify-content: center;\n        ",e.innerHTML='\n            <div style="background: var(--dark-secondary); padding: 3rem; border-radius: 25px; max-width: 500px; width: 90%; position: relative;">\n                <button onclick="closeModal()" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: white; font-size: 2rem; cursor: pointer;">✕</button>\n                \n                <h3 style="color: var(--text-primary); margin-bottom: 2rem; text-align: center;">Calcula Tu ROI en 30 Segundos</h3>\n                \n                <div style="margin-bottom: 1.5rem;">\n                    <label style="color: var(--text-secondary); display: block; margin-bottom: 0.5rem;">¿Cuántas consultas recibes por día?</label>\n                    <input id="dailyQueries" type="number" placeholder="Ej: 50" style="width: 100%; padding: 1rem; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white;">\n                </div>\n                \n                <div style="margin-bottom: 1.5rem;">\n                    <label style="color: var(--text-secondary); display: block; margin-bottom: 0.5rem;">¿Cuál es tu ticket promedio de venta en USD?</label>\n                    <input id="avgTicket" type="number" placeholder="Ej: 150" style="width: 100%; padding: 1rem; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white;">\n                </div>\n                \n                <button onclick="calculateROI()" style="width: 100%; padding: 1rem; background: var(--gradient-primary); border: none; border-radius: 10px; color: white; font-weight: 600; cursor: pointer; margin-bottom: 1rem;">Calcular Mi ROI</button>\n                \n                <div id="roiResult" style="text-align: center; color: var(--text-primary); font-size: 1.2rem; font-weight: 600;"></div>\n            </div>\n        ',document.body.appendChild(e),this.interactions.setupKeyboardShortcuts(),this.interactions.setupClickOutside(e,()=>closeModal())}setupInteractiveElements(){document.querySelectorAll(".result-card").forEach(e=>{this.interactions.addHoverEffect(e,()=>e.style.transform="translateY(-15px) scale(1.02) rotateY(5deg)",()=>e.style.transform="translateY(0) scale(1) rotateY(0deg)")}),document.querySelectorAll(".timeline-marker").forEach(e=>{this.interactions.addClickTracking(e,()=>{e.style.animation="none",e.offsetHeight,e.style.animation="bounce 0.6s ease"})});const e=document.querySelector(".achievement-showcase");e&&this.interactions.addClickTracking(e,()=>{e.style.transform="scale(0.98)",setTimeout(()=>{e.style.transform="scale(1)"},150)})}}